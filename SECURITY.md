# Security

## Security Model

### How Fairness Is Ensured

1. **On-Chain Seed Generation**
   - Random seed is generated by the smart contract using blockchain data
   - Includes: block timestamp, block round, pot total, entry count
   - Seed is logged on-chain and cannot be changed

2. **Deterministic Winner Selection**
   - Winners are calculated using Java's Random algorithm
   - Same seed always produces same winners
   - Algorithm is public and verifiable

3. **Controlled Winner Registration**
   - Only the contract creator can register winners
   - Winners must match the calculated results from the seed
   - Any mismatch is detectable via verification tools

4. **Public Verification**
   - Anyone can verify any draw at any time
   - Verification script recalculates winners from blockchain seed
   - If registered winners don't match, manipulation is proven

### Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Smart Contract (On-Chain)           â”‚
â”‚  1. Generate seed (unpredictable)          â”‚
â”‚  2. Log seed (public, immutable)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
         Seed: 5352984041323284126
                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚
        â–¼                   â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Backend â”‚         â”‚  Anyone â”‚
   â”‚ (calc)  â”‚         â”‚ (verify)â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
        â”‚                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–¼
          Same Winners!
```

## Verification

### Independent Verification

Anyone can verify fairness:

```bash
# Install
pip install requests

# Verify any cycle
python3 verify_draw.py 7
```

### What Verification Checks

âœ… Seed from blockchain matches registered seed
âœ… Calculated winners match registered winners
âœ… All tier 1, 2, and 3 winners are correct
âœ… Prize amounts are correct

### If Verification Fails

If the verification script shows a mismatch:
- âŒ The draw has been manipulated
- ğŸš¨ This is proof of fraud
- ğŸ“¢ Report it immediately

This is why the system is **provably fair** - manipulation is mathematically impossible to hide.

## Security Best Practices

### For Users

1. **Always verify draws** you participate in
2. **Don't trust, verify** - run the script yourself
3. **Check blockchain directly** using the seed retrieval tools
4. **Report any mismatches** immediately

### For Developers

1. **Review the smart contract** (`lottery_contract.py`)
2. **Audit the verification logic** (`verify_draw.py`)
3. **Check blockchain data** yourself
4. **Open issues** if you find problems

## Known Issues

### Tier 3 Winner Count Discrepancy

**The Situation:**
- Smart contract allocates storage for 20 Tier 3 winners
- Backend implementation selects 10 Tier 3 winners
- This is a mismatch between contract and code

**Why?**
Honest answer: We went live with 10 winners and didn't want to change it after launch. The contract was designed for 20, but the backend was implemented with 10, and we decided to keep things stable rather than risk changes to a live system.

**Impact:**
- âœ… System works correctly
- âœ… All prize money is distributed (15% split among 10 winners)
- âœ… Still provably fair and verifiable
- âš ï¸ Paying for unused box storage (~10 empty slots)
- âš ï¸ Each Tier 3 winner gets ~1.5% of pot instead of ~0.75%

**Could we fix it?** Yes, but it would require:
- Backend changes and thorough testing
- Risk of introducing bugs to live system
- No security or fairness benefit

**Decision:** Keep it stable. It works, it's fair, and changing it adds risk without real benefit.

## Responsible Disclosure

Found a security vulnerability?

**Please report it responsibly:**
- ğŸ“§ **Email**: info@algodailylottery.com
- ğŸ¦ **Twitter**: [@algodailylottery](https://twitter.com/algodailylottery)
- ğŸ› **GitHub Issues**: [Open an issue](https://github.com/algodailylottery/algo-daily-lottery-verification-public/issues)

We take security seriously and will respond promptly.

## Audit Status

- **Smart Contract**: Public, open-source (not formally audited)
- **Verification Tools**: Open-source, community auditable
- **Historical Draws**: All verified as fair (Cycles 1-7)

## Transparency Commitment

We believe in radical transparency:
- âœ… All code is open source
- âœ… All draws are verifiable
- âœ… All seeds are on-chain
- âœ… All issues are publicly tracked

**Don't trust us. Verify everything.**

## License

This security documentation is provided as-is under MIT License.

---

*Last updated: 2026-01-01*
